# postgresql_parser
# Курсовая 5. Работа с базами данных 
В рамках проекта вам необходимо получить данные о компаниях и вакансиях с сайта hh.ru, спроектировать таблицы в БД PostgreSQL и загрузить полученные данные в созданные таблицы.

Описание проекта
Данный проект является примером парсинга сайта с помощью библиотеки requests и сохранением полученных данных в базу данных PostgreSQL с помощью библиотеки psycopg2.

Сайт, с которого происходит парсинг, представляет собой API сервис, который предоставляет данные о вакансиях. Для доступа к API необходимо получить и использовать токен авторизации.

В проекте реализован класс DBManager, который осуществляет подключение к базе данных и сохранение данных в таблицы companies и vacancies. Данные о компаниях и вакансиях извлекаются с помощью методов get_companies() и get_vacancies(), соответственно, используя API сайта.

Запуск проекта
Для запуска проекта необходимо выполнить следующие шаги:

1. Установить необходимые библиотеки, перечисленные в файле requirements.txt, используя команду:

pip install -r requirements.txt

2. Создать базу данных PostgreSQL и выполнить скрипт db_scripts.sql, чтобы создать необходимые таблицы.

3. Запустить файл main.py, используя команду:

python main.py
После выполнения скрипта, данные о компаниях и вакансиях будут сохранены в базу данных.

# Методы
Метод get_companies_and_vacancies_count выполняет запрос к БД, который возвращает список всех компаний и количество вакансий у каждой компании.

Метод get_all_vacancies выполняет запрос к БД, который возвращает список всех вакансий с указанием названия компании, названия вакансии и зарплаты и ссылки на вакансию.

Метод get_avg_salary выполняет запрос к БД, который возвращает среднюю зарплату по всем вакансиям.

Метод get_vacancies_with_higher_salary использует метод get_avg_salary для получения средней зарплаты и выполняет запрос к БД, который возвращает список всех вакансий, у которых зарплата выше средней по всем вакансиям.

Метод get_vacancies_with_keyword выполняет запрос к БД, который возвращает список всех вакансий, в названии которых содержатся переданные в метод слова, например “python”.

Метод save_vacancies принимает список вакансий vacancies, каждая вакансия в формате словаря. Для каждой вакансии происходит попытка выполнить INSERT INTO в таблицу vacancies. Если вакансия с таким vacancy_id уже существует в таблице, то происходит обновление ее данных через ON CONFLICT. После того как все вакансии были обработаны, изменения сохраняются в базу данных через self.conn.commit().
